{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/alok/Projects/audio-guide/Backend/audioguide-app/src/app/dashboard/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport axios from 'axios'\nimport { TrashIcon } from '@heroicons/react/24/outline'\n\ninterface Guide {\n  title: string;\n  content: string;\n  createdAt: string;\n  hash?: string;\n  fileId?: string;\n  portalAddress?: string;\n  storedContent?: string;\n}\n\nexport default function DashboardPage() {\n  const router = useRouter()\n  const [walletAddress, setWalletAddress] = useState<string | null>(null)\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [isLoading, setIsLoading] = useState(true)\n  const [title, setTitle] = useState('')\n  const [content, setContent] = useState('')\n  const [guides, setGuides] = useState<Guide[]>([])\n  const [isDeployingAgent, setIsDeployingAgent] = useState(false)\n\n  useEffect(() => {\n    // Check if user is connected\n    const address = localStorage.getItem('walletAddress')\n    if (!address) {\n      router.push('/')\n      return\n    }\n    setWalletAddress(address)\n    \n    // Fetch existing guides\n    fetchExistingGuides()\n  }, [router])\n\n  const fetchExistingGuides = async () => {\n    try {\n      const response = await axios.get('/api/guides')\n      if (response.data.guides) {\n        setGuides(response.data.guides)\n      }\n    } catch (error) {\n      console.error('Failed to fetch existing guides:', error)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const uploadToIPFS = async (content: string) => {\n    try {\n      const response = await axios.post('/api/upload', { content })\n      return {\n        hash: response.data.hash,\n        fileId: response.data.fileId,\n        content: response.data.content,\n        portalAddress: response.data.portalAddress\n      }\n    } catch (error) {\n      console.error('Failed to upload to IPFS:', error)\n      throw new Error('Failed to upload to IPFS')\n    }\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!title.trim() || !content.trim()) return\n\n    try {\n      setIsSubmitting(true)\n\n      // Create markdown content\n      const markdownContent = `# ${title}\\n\\n${content}`\n      \n      // Upload using Fileverse\n      const { hash, fileId, content: storedContent, portalAddress } = await uploadToIPFS(markdownContent)\n      console.log('File uploaded to Fileverse:', { hash, fileId, portalAddress })\n\n      const newGuide = {\n        title,\n        content,\n        createdAt: new Date().toISOString(),\n        hash,\n        fileId,\n        portalAddress,\n        storedContent\n      }\n      setGuides(prev => [newGuide, ...prev])\n      setTitle('')\n      setContent('')\n      alert('Guide preview created and stored successfully!')\n    } catch (error) {\n      console.error('Failed to create guide:', error)\n      alert('Failed to create guide preview')\n    } finally {\n      setIsSubmitting(false)\n    }\n  }\n\n  const handleDelete = async (fileId: string, index: number) => {\n    if (!confirm('Are you sure you want to delete this guide?')) return\n\n    try {\n      const response = await axios.post('/api/upload', { \n        action: 'delete',\n        fileId \n      })\n\n      if (response.data.success) {\n        setGuides(prev => prev.filter((_, i) => i !== index))\n        alert('Guide deleted successfully!')\n      }\n    } catch (error) {\n      console.error('Failed to delete guide:', error)\n      alert('Failed to delete guide')\n    }\n  }\n\n  const deployGuideAgent = async () => {\n    if (guides.length === 0) {\n      alert('Please create at least one guide before deploying an agent')\n      return\n    }\n\n    try {\n      setIsDeployingAgent(true)\n\n      const response = await axios.post('/api/deploy-agent', { guides })\n\n      if (response.data.success) {\n        alert('Guide Agent deployed successfully!')\n      } else {\n        throw new Error(response.data.error || 'Failed to deploy agent')\n      }\n    } catch (error) {\n      console.error('Failed to deploy guide agent:', error)\n      alert('Failed to deploy guide agent')\n    } finally {\n      setIsDeployingAgent(false)\n    }\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900\">\n        <div className=\"text-gray-600 dark:text-gray-400\">Loading...</div>\n      </div>\n    )\n  }\n\n  if (!walletAddress) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900\">\n        <div className=\"text-gray-600 dark:text-gray-400\">\n          No wallet connected. Redirecting...\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Dashboard</h1>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"flex items-center\">\n                <div className=\"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-sm mr-2\">\n                  {walletAddress?.slice(2, 4)}\n                </div>\n                <span className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  {walletAddress?.slice(0, 6)}...{walletAddress?.slice(-4)}\n                </span>\n              </div>\n              <button\n                onClick={() => {\n                  localStorage.removeItem('walletAddress')\n                  router.push('/')\n                }}\n                className=\"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white\"\n              >\n                Disconnect\n              </button>\n            </div>\n          </div>\n\n          <div className=\"space-y-8\">\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-4\">\n                Preview Guide Content\n              </h2>\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Title\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={title}\n                    onChange={(e) => setTitle(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Content\n                  </label>\n                  <textarea\n                    value={content}\n                    onChange={(e) => setContent(e.target.value)}\n                    rows={6}\n                    placeholder=\"Write your guide content here. This will be converted to an audio guide later.\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600\"\n                    required\n                  />\n                </div>\n                <button\n                  type=\"submit\"\n                  disabled={isSubmitting}\n                  className=\"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\"\n                >\n                  {isSubmitting ? 'Creating Preview...' : 'Create Preview'}\n                </button>\n              </form>\n            </div>\n\n            <div>\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                  Your Guide Previews\n                </h2>\n                <button\n                  onClick={deployGuideAgent}\n                  disabled={isDeployingAgent || guides.length === 0}\n                  className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 \n                    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 \n                    disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2\"\n                >\n                  {isDeployingAgent ? (\n                    <>\n                      <span className=\"animate-spin\">âš¡</span>\n                      <span>Deploying Agent...</span>\n                    </>\n                  ) : (\n                    <>\n                      <span>ðŸ¤–</span>\n                      <span>Deploy Guide Agent</span>\n                    </>\n                  )}\n                </button>\n              </div>\n              {guides.length === 0 ? (\n                <div className=\"text-gray-600 dark:text-gray-400 text-center py-8\">\n                  No guide previews created yet\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {guides.map((guide, index) => (\n                    <div\n                      key={index}\n                      className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow relative\"\n                    >\n                      <h3 className=\"font-semibold text-gray-900 dark:text-white mb-2\">\n                        {guide.title}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-3\">\n                        {guide.content}\n                      </p>\n                      <div className=\"text-xs text-gray-500 dark:text-gray-400 space-y-1\">\n                        <div className=\"flex justify-between items-center\">\n                          <span>Created: {new Date(guide.createdAt).toLocaleDateString()}</span>\n                          {guide.hash && (\n                            <span className=\"text-indigo-600 dark:text-indigo-400\">\n                              Hash: {guide.hash.slice(0, 6)}...{guide.hash.slice(-4)}\n                            </span>\n                          )}\n                        </div>\n                        {guide.fileId && (\n                          <div className=\"flex justify-between items-center\">\n                            <span>File ID: {guide.fileId}</span>\n                            {guide.portalAddress && (\n                              <span className=\"text-indigo-600 dark:text-indigo-400\">\n                                Portal: {guide.portalAddress.slice(0, 6)}...{guide.portalAddress.slice(-4)}\n                              </span>\n                            )}\n                          </div>\n                        )}\n                        {guide.storedContent && (\n                          <div className=\"mt-2 p-2 bg-gray-100 dark:bg-gray-600 rounded\">\n                            <div className=\"text-xs font-medium mb-1\">Stored Content:</div>\n                            <pre className=\"text-xs whitespace-pre-wrap\">\n                              {guide.storedContent}\n                            </pre>\n                          </div>\n                        )}\n                        <div className=\"absolute top-3 right-3\">\n                          <button\n                            onClick={() => guide.fileId && handleDelete(guide.fileId, index)}\n                            className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors border-2 border-gray-200 dark:border-gray-600 hover:border-red-200 dark:hover:border-red-800\"\n                            disabled={!guide.fileId}\n                            title=\"Delete Guide\"\n                          >\n                            <TrashIcon className=\"w-4 h-4\" />\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 617, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}